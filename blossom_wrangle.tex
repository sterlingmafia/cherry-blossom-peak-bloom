% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Cherry Blossom Prediction 2023},
  pdfauthor={Alayna Schoenberger and Gabriel Brehm},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Cherry Blossom Prediction 2023}
\author{Alayna Schoenberger and Gabriel Brehm}
\date{2023-02-28}

\begin{document}
\maketitle

When we heard about the cherry blossom prediction competition, our
thoughts lept to prediction markets and ``wisdom-of-the-crowds''
methods. According to the work of Philip Tetlock and his collaborators,
trained human forecasters combined in a weighted average with mass crowd
predictions consistently outperform even the best machine learning and
statistical models in similar forecasting efforts. The core of the idea
is quite simple. Each person in the crowd has some amount of true and
useful information about the desired prediction, and some amount of
incorrect information (bias and random error). By aggregating the
predictions of each person, randomness and random bias cancel each other
out, and the true and useful begins to dominate the prediction. Trained,
practiced forecasters contribute a larger amount of true information on
average, so in a weighted average against an untrained crowd they
receive a higher weighting. Tetlock's organization, the Good Judgment
Project, has empirically discovered these weightings over years of
study. Time, resource, and rule constraints precluded our ability to
garner a prediction in such a way. However, we drew inspiration from the
core of the idea to create our own ``wisdom of the crowds'' method. We
decided to collect as many previously-submitted cherry blossom bloom
prediction models as possible, update them with the latest data, and
re-run them to obtain new predictions. We would run the models on past
data to obtain their past predictions, then use these past predictions
to create a weighted average of the models. Finally, we would use the
weightings and the future predictions of the models to generate our own
future predictions. The core of the idea remains the same as the
wisdom-of-the-crowds model: each model is based on similar (but usually
not identical) data. Each model uses different methods to achieve its
predictions. We therefore assume that each model contains some true and
useful information, some bias, and some random error. By creating a
weighted average of their predictions, we hope to reduce some bias
inherent in the models without an increase in variance, thus improving
the bias-variance tradeoff. Finding the models proved to be a challenge.
We were not able to look at submitted competition models directly.
Instead, we searched through forked github repositories from the main
GMU-CherryBlossomCompetition branch. Parsing through nearly a hundred of
these, we found those which warranted further investigation. We then
explored these models one-by-one to determine which might be viable
candidates for our final model. Candidates were evaluated for their
working code, substantive modeling efforts, variety in data sources, and
types of models. Due to the enormous time required to parse and update
each model, and the limited variability in available models, we chose
five models for our final submission: * stevenlio88 * siyueyang
(previous award winner) * mattharding23 (previous award winner) *
kenkoonwong (previous award winner) * Daria-Kearny In the future, we
feel that a similar effort with more models and possibly with more
sophisticated methods for determining model weights should outperform
any individual model. Potential methods include recurrent neural
networks, LSTM, or various methods of time series regression.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# load in known actuals for each city}
\NormalTok{kyoto }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"\textasciitilde{}/Projects/Cherry Blossoms/OG Data/peak{-}bloom{-}prediction/data/kyoto.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 834 Columns: 7
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## chr  (1): location
## dbl  (5): lat, long, alt, year, bloom_doy
## date (1): bloom_date
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{liestal }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"\textasciitilde{}/Projects/Cherry Blossoms/OG Data/peak{-}bloom{-}prediction/data/liestal.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 129 Columns: 7
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## chr  (1): location
## dbl  (5): lat, long, alt, year, bloom_doy
## date (1): bloom_date
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{washingtondc }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"\textasciitilde{}/Projects/Cherry Blossoms/OG Data/peak{-}bloom{-}prediction/data/washingtondc.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 102 Columns: 7
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## chr  (1): location
## dbl  (5): lat, long, alt, year, bloom_doy
## date (1): bloom_date
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vancouver }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"\textasciitilde{}/Projects/Cherry Blossoms/OG Data/peak{-}bloom{-}prediction/data/vancouver.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 1 Columns: 7
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## chr  (1): location
## dbl  (5): lat, long, alt, year, bloom_doy
## date (1): bloom_date
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# load in predictions from each of our five models}
\NormalTok{blooms\_sl }\OtherTok{\textless{}{-}} \FunctionTok{read\_excel}\NormalTok{(}\StringTok{"\textasciitilde{}/Projects/Cherry Blossoms/consolidated\_blooms.xlsx"}\NormalTok{, }
    \AttributeTok{sheet =} \StringTok{"stevenlio88"}\NormalTok{)}

\NormalTok{blooms\_kkw }\OtherTok{\textless{}{-}} \FunctionTok{read\_excel}\NormalTok{(}\StringTok{"\textasciitilde{}/Projects/Cherry Blossoms/consolidated\_blooms.xlsx"}\NormalTok{, }
    \AttributeTok{sheet =} \StringTok{"kenkoonwong"}\NormalTok{)}

\NormalTok{blooms\_dk }\OtherTok{\textless{}{-}} \FunctionTok{read\_excel}\NormalTok{(}\StringTok{"\textasciitilde{}/Projects/Cherry Blossoms/consolidated\_blooms.xlsx"}\NormalTok{, }
    \AttributeTok{sheet =} \StringTok{"Daria{-}Kearney"}\NormalTok{)}

\NormalTok{blooms\_mh }\OtherTok{\textless{}{-}} \FunctionTok{read\_excel}\NormalTok{(}\StringTok{"\textasciitilde{}/Projects/Cherry Blossoms/consolidated\_blooms.xlsx"}\NormalTok{, }
    \AttributeTok{sheet =} \StringTok{"mattharding"}\NormalTok{)}

\NormalTok{blooms\_syy }\OtherTok{\textless{}{-}} \FunctionTok{read\_excel}\NormalTok{(}\StringTok{"\textasciitilde{}/Projects/Cherry Blossoms/consolidated\_blooms.xlsx"}\NormalTok{, }
    \AttributeTok{sheet =} \StringTok{"siyueyang"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Get the actuals into a state we like, starting with making sure that these columns will be clear in the final merged data frame}
\NormalTok{kyoto}\SpecialCharTok{$}\NormalTok{kyoto\_day }\OtherTok{\textless{}{-}}\NormalTok{ kyoto}\SpecialCharTok{$}\NormalTok{bloom\_doy}
\NormalTok{liestal}\SpecialCharTok{$}\NormalTok{liestal\_day }\OtherTok{\textless{}{-}}\NormalTok{ liestal}\SpecialCharTok{$}\NormalTok{bloom\_doy}
\NormalTok{washingtondc}\SpecialCharTok{$}\NormalTok{dc\_day }\OtherTok{\textless{}{-}}\NormalTok{ washingtondc}\SpecialCharTok{$}\NormalTok{bloom\_doy}
\NormalTok{vancouver}\SpecialCharTok{$}\NormalTok{vancouver\_day }\OtherTok{\textless{}{-}}\NormalTok{ vancouver}\SpecialCharTok{$}\NormalTok{bloom\_doy}

\NormalTok{kyoto.join }\OtherTok{\textless{}{-}}\NormalTok{ kyoto }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(year, kyoto\_day)}
\NormalTok{liestal.join }\OtherTok{\textless{}{-}}\NormalTok{ liestal }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(year, liestal\_day)}
\NormalTok{dc.join }\OtherTok{\textless{}{-}}\NormalTok{ washingtondc }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(year, dc\_day)}
\NormalTok{vancouver.join }\OtherTok{\textless{}{-}}\NormalTok{ vancouver }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(year, vancouver\_day)}

\NormalTok{bloom\_date }\OtherTok{\textless{}{-}} \FunctionTok{full\_join}\NormalTok{(kyoto.join, liestal.join, }\AttributeTok{by =} \StringTok{"year"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{full\_join}\NormalTok{(dc.join, }\AttributeTok{by =} \StringTok{"year"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{full\_join}\NormalTok{(vancouver.join, }\AttributeTok{by =} \StringTok{"year"}\NormalTok{)}

\CommentTok{\# Daria{-}Kearney\textquotesingle{}s model didn\textquotesingle{}t give round numbers, need to fix that}
\NormalTok{blooms\_dk }\OtherTok{\textless{}{-}}\NormalTok{ blooms\_dk }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\StringTok{"year"} \OtherTok{=}\NormalTok{ Year,}
                                  \StringTok{"kyoto\_dk"} \OtherTok{=} \FunctionTok{round}\NormalTok{(kyoto),}
                                  \StringTok{"liestal\_dk"} \OtherTok{=} \FunctionTok{round}\NormalTok{(liestal),}
                                  \StringTok{"dc\_dk"} \OtherTok{=} \FunctionTok{round}\NormalTok{(dc),}
                                  \StringTok{"vancouver\_dk"} \OtherTok{=} \FunctionTok{round}\NormalTok{(vancouver)}
\NormalTok{)}

\NormalTok{blooms\_kkw }\OtherTok{\textless{}{-}}\NormalTok{ blooms\_kkw }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\StringTok{"year"} \OtherTok{=}\NormalTok{ Year,}
                                  \StringTok{"kyoto\_kkw"} \OtherTok{=} \FunctionTok{round}\NormalTok{(kyoto),}
                                  \StringTok{"liestal\_kkw"} \OtherTok{=} \FunctionTok{round}\NormalTok{(liestal),}
                                  \StringTok{"dc\_kkw"} \OtherTok{=} \FunctionTok{round}\NormalTok{(dc),}
                                  \StringTok{"vancouver\_kkw"} \OtherTok{=} \FunctionTok{round}\NormalTok{(vancouver)}
\NormalTok{)}

\NormalTok{blooms\_mh }\OtherTok{\textless{}{-}}\NormalTok{ blooms\_mh }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\StringTok{"kyoto\_mh"} \OtherTok{=} \FunctionTok{as.numeric}\NormalTok{(kyoto),}
                                  \StringTok{"liestal\_mh"} \OtherTok{=} \FunctionTok{as.numeric}\NormalTok{(liestal),}
                                  \StringTok{"dc\_mh"} \OtherTok{=} \FunctionTok{round}\NormalTok{(washingtondc),}
                                  \StringTok{"vancouver\_mh"} \OtherTok{=} \FunctionTok{round}\NormalTok{(vancouver)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: There were 2 warnings in `mutate()`.
## The first warning was:
## i In argument: `kyoto_mh = as.numeric(kyoto)`.
## Caused by warning:
## ! NAs introduced by coercion
## i Run ]8;;ide:run:dplyr::last_dplyr_warnings()dplyr::last_dplyr_warnings()]8;; to see the 1 remaining warning.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{blooms\_sl }\OtherTok{\textless{}{-}}\NormalTok{ blooms\_sl }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\StringTok{"year"} \OtherTok{=}\NormalTok{ Year,}
                                  \StringTok{"kyoto\_sl"} \OtherTok{=} \FunctionTok{as.numeric}\NormalTok{(kyoto),}
                                  \StringTok{"liestal\_sl"} \OtherTok{=} \FunctionTok{as.numeric}\NormalTok{(liestal),}
                                  \StringTok{"dc\_sl"} \OtherTok{=} \FunctionTok{round}\NormalTok{(dc),}
                                  \StringTok{"vancouver\_sl"} \OtherTok{=} \FunctionTok{as.numeric}\NormalTok{(vancouver)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: There were 2 warnings in `mutate()`.
## The first warning was:
## i In argument: `liestal_sl = as.numeric(liestal)`.
## Caused by warning:
## ! NAs introduced by coercion
## i Run ]8;;ide:run:dplyr::last_dplyr_warnings()dplyr::last_dplyr_warnings()]8;; to see the 1 remaining warning.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{blooms\_syy }\OtherTok{\textless{}{-}}\NormalTok{ blooms\_syy }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\StringTok{"kyoto\_syy"} \OtherTok{=} \FunctionTok{round}\NormalTok{(kyoto),}
                                  \StringTok{"liestal\_syy"} \OtherTok{=} \FunctionTok{round}\NormalTok{(liestal),}
                                  \StringTok{"dc\_syy"} \OtherTok{=} \FunctionTok{round}\NormalTok{(washingtondc),}
                                  \StringTok{"vancouver\_syy"} \OtherTok{=} \FunctionTok{round}\NormalTok{(vancouver)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Most of our models cut off at 2000, so we will start there for best data completeness. }
\NormalTok{models\_and\_actuals }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(bloom\_date, year }\SpecialCharTok{\textgreater{}=} \DecValTok{2000}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{full\_join}\NormalTok{(dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(blooms\_dk, year }\SpecialCharTok{\textgreater{}=} \DecValTok{2000}\NormalTok{), }\AttributeTok{by =} \StringTok{"year"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{full\_join}\NormalTok{(dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(blooms\_kkw, year }\SpecialCharTok{\textgreater{}=} \DecValTok{2000}\NormalTok{), }\AttributeTok{by =} \StringTok{"year"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{full\_join}\NormalTok{(dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(blooms\_mh, year }\SpecialCharTok{\textgreater{}=} \DecValTok{2000}\NormalTok{), }\AttributeTok{by =} \StringTok{"year"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{full\_join}\NormalTok{(dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(blooms\_sl, year }\SpecialCharTok{\textgreater{}=} \DecValTok{2000}\NormalTok{), }\AttributeTok{by =} \StringTok{"year"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{full\_join}\NormalTok{(dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(blooms\_syy, year }\SpecialCharTok{\textgreater{}=} \DecValTok{2000}\NormalTok{), }\AttributeTok{by =} \StringTok{"year"}\NormalTok{)}

\NormalTok{models\_and\_actuals.pre23 }\OtherTok{\textless{}{-}}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(models\_and\_actuals, year }\SpecialCharTok{\textless{}} \DecValTok{2023}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{basic-visualizations}{%
\subsection{Basic Visualizations}\label{basic-visualizations}}

our first explorations gave us hope. DC's actual numbers are close to
the predictions made for past years by the models. The same is true for
both Liestal and Kyoto. Vancouver's actual bloom dates weren't part of
the main data set and uncovering them would have been a misappropriation
of team resources.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{plot.dc.pre }\OtherTok{\textless{}{-}}\NormalTok{ models\_and\_actuals }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(year }\SpecialCharTok{\textless{}} \DecValTok{2023}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ year)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ dc\_day), }\AttributeTok{colour =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ dc\_day), }\AttributeTok{colour =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ dc\_dk), }\AttributeTok{colour =} \StringTok{"blue"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ dc\_kkw), }\AttributeTok{colour =} \StringTok{"green"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ dc\_mh), }\AttributeTok{colour =} \StringTok{"violet"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ dc\_sl), }\AttributeTok{colour =} \StringTok{"orange"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ dc\_syy), }\AttributeTok{colour =} \StringTok{"red"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Predictions and Actuals for DC"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ylab}\NormalTok{(}\StringTok{"Day of Year"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{xlab}\NormalTok{(}\StringTok{"Year"}\NormalTok{)}
\NormalTok{plot.dc.pre}
\end{Highlighting}
\end{Shaded}

\includegraphics{blossom_wrangle_files/figure-latex/models_and_actuals_visualized-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{plot.liestal.pre }\OtherTok{\textless{}{-}}\NormalTok{ models\_and\_actuals }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(year }\SpecialCharTok{\textless{}} \DecValTok{2023}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ year)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ liestal\_day), }\AttributeTok{colour =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ liestal\_day), }\AttributeTok{colour =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ liestal\_dk), }\AttributeTok{colour =} \StringTok{"blue"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ liestal\_kkw), }\AttributeTok{colour =} \StringTok{"green"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ liestal\_mh), }\AttributeTok{colour =} \StringTok{"violet"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ liestal\_sl), }\AttributeTok{colour =} \StringTok{"orange"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ liestal\_syy), }\AttributeTok{colour =} \StringTok{"red"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Predictions and Actuals for Liestal"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ylab}\NormalTok{(}\StringTok{"Day of Year"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{xlab}\NormalTok{(}\StringTok{"Year"}\NormalTok{)}
\NormalTok{plot.liestal.pre}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 1 rows containing missing values (`geom_point()`).
\end{verbatim}

\begin{verbatim}
## Warning: Removed 3 rows containing missing values (`geom_point()`).
\end{verbatim}

\includegraphics{blossom_wrangle_files/figure-latex/models_and_actuals_visualized-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{plot.kyoto.pre }\OtherTok{\textless{}{-}}\NormalTok{ models\_and\_actuals }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(year }\SpecialCharTok{\textless{}} \DecValTok{2023}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ year)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ kyoto\_day), }\AttributeTok{colour =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ kyoto\_day), }\AttributeTok{colour =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ kyoto\_dk), }\AttributeTok{colour =} \StringTok{"blue"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ kyoto\_kkw), }\AttributeTok{colour =} \StringTok{"green"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ kyoto\_mh), }\AttributeTok{colour =} \StringTok{"violet"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ kyoto\_sl), }\AttributeTok{colour =} \StringTok{"orange"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ kyoto\_syy), }\AttributeTok{colour =} \StringTok{"red"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Predictions and Actuals for Kyoto"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ylab}\NormalTok{(}\StringTok{"Day of Year"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{xlab}\NormalTok{(}\StringTok{"Year"}\NormalTok{)}
\NormalTok{plot.kyoto.pre}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 1 rows containing missing values (`geom_point()`).
\end{verbatim}

\includegraphics{blossom_wrangle_files/figure-latex/models_and_actuals_visualized-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{plot.vancouver.pre }\OtherTok{\textless{}{-}}\NormalTok{ models\_and\_actuals }\SpecialCharTok{\%\textgreater{}\%}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(year }\SpecialCharTok{\textless{}} \DecValTok{2023} \SpecialCharTok{\&}\NormalTok{ year }\SpecialCharTok{\textgreater{}} \DecValTok{2006}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ year)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ vancouver\_dk), }\AttributeTok{colour =} \StringTok{"blue"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ vancouver\_kkw), }\AttributeTok{colour =} \StringTok{"green"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ vancouver\_sl), }\AttributeTok{colour =} \StringTok{"orange"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Predictions for Vancouver"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{ylab}\NormalTok{(}\StringTok{"Day of Year"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{xlab}\NormalTok{(}\StringTok{"Year"}\NormalTok{)}
\NormalTok{plot.vancouver.pre}
\end{Highlighting}
\end{Shaded}

\includegraphics{blossom_wrangle_files/figure-latex/models_and_actuals_visualized-4.pdf}

\hypertarget{linear-modeling}{%
\subsection{Linear Modeling}\label{linear-modeling}}

Since we were looking only for a weighted average of the models, we
forced the intercept to 0. This also reduced the danger of overfitting.
Between this and the low amount of data available acrosss all 5 models,
we chose not to split into training and test sets.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# DC\textquotesingle{}s weighted average}
\NormalTok{line.dc }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(}\AttributeTok{data =}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(models\_and\_actuals, year }\SpecialCharTok{\textless{}} \DecValTok{2023}\NormalTok{), dc\_day }\SpecialCharTok{\textasciitilde{}} \DecValTok{0} \SpecialCharTok{+}\NormalTok{ dc\_dk }\SpecialCharTok{+}\NormalTok{ dc\_kkw }\SpecialCharTok{+}\NormalTok{ dc\_mh }\SpecialCharTok{+}\NormalTok{ dc\_sl }\SpecialCharTok{+}\NormalTok{ dc\_syy)}
\NormalTok{line.dc.summ }\OtherTok{\textless{}{-}} \FunctionTok{summary}\NormalTok{(line.dc)}
\CommentTok{\# Get MSE\textquotesingle{}s}
\NormalTok{line.dc.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(line.dc.summ}\SpecialCharTok{$}\NormalTok{residuals}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{dk.dc.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{dc\_day }\SpecialCharTok{{-}}\NormalTok{ models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{dc\_dk)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{kkw.dc.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{dc\_day }\SpecialCharTok{{-}}\NormalTok{ models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{dc\_kkw)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{mh.dc.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{dc\_day }\SpecialCharTok{{-}}\NormalTok{ models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{dc\_mh)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{sl.dc.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{dc\_day }\SpecialCharTok{{-}}\NormalTok{ models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{dc\_sl)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{syy.dc.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{dc\_day }\SpecialCharTok{{-}}\NormalTok{ models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{dc\_syy)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\CommentTok{\# MSE DF}
\NormalTok{dc.mse }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(line.dc.mse, dk.dc.mse, kkw.dc.mse, mh.dc.mse, sl.dc.mse, syy.dc.mse)}
\NormalTok{mse\_names }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"DC Regression MSE"}\NormalTok{, }\StringTok{"DC DK MSE"}\NormalTok{, }\StringTok{"DC KKW MSE"}\NormalTok{, }\StringTok{"DC MH MSE"}\NormalTok{, }\StringTok{"DC SL MSE"}\NormalTok{, }\StringTok{"DC SYY MSE"}\NormalTok{)}
\NormalTok{dc\_mse }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(mse\_names, dc.mse)}
\NormalTok{dc\_mse}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##           mse_names    dc.mse
## 1 DC Regression MSE  4.795099
## 2         DC DK MSE  6.217391
## 3        DC KKW MSE 41.695652
## 4         DC MH MSE 53.652174
## 5         DC SL MSE 23.478261
## 6        DC SYY MSE 44.478261
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Liestal\textquotesingle{}s weighted average}
\NormalTok{line.liestal }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(}\AttributeTok{data =}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(models\_and\_actuals, year }\SpecialCharTok{\textless{}} \DecValTok{2023}\NormalTok{), liestal\_day }\SpecialCharTok{\textasciitilde{}} \DecValTok{0} \SpecialCharTok{+}\NormalTok{ liestal\_dk }\SpecialCharTok{+}\NormalTok{ liestal\_kkw }\SpecialCharTok{+}\NormalTok{ liestal\_mh }\SpecialCharTok{+}\NormalTok{ liestal\_sl }\SpecialCharTok{+}\NormalTok{ liestal\_syy)}
\NormalTok{line.liestal.summ }\OtherTok{\textless{}{-}} \FunctionTok{summary}\NormalTok{(line.liestal)}
\NormalTok{line.liestal.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(line.liestal.summ}\SpecialCharTok{$}\NormalTok{residuals}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\CommentTok{\# Get MSE\textquotesingle{}s}
\NormalTok{dk.liestal.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{liestal\_day }\SpecialCharTok{{-}}\NormalTok{ models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{liestal\_dk)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{kkw.liestal.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{liestal\_day }\SpecialCharTok{{-}}\NormalTok{ models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{liestal\_kkw)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{mh.liestal.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{liestal\_day }\SpecialCharTok{{-}}\NormalTok{ models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{liestal\_mh)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{sl.liestal.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{liestal\_day }\SpecialCharTok{{-}}\NormalTok{ models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{liestal\_sl)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{syy.liestal.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{liestal\_day }\SpecialCharTok{{-}}\NormalTok{ models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{liestal\_syy)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\CommentTok{\# MSE DF}
\NormalTok{liestal.mse }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(line.liestal.mse, dk.liestal.mse, kkw.liestal.mse, mh.liestal.mse, sl.liestal.mse, syy.liestal.mse)}
\NormalTok{mse\_names }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"liestal Regression MSE"}\NormalTok{, }\StringTok{"liestal DK MSE"}\NormalTok{, }\StringTok{"liestal KKW MSE"}\NormalTok{, }\StringTok{"liestal MH MSE"}\NormalTok{, }\StringTok{"liestal SL MSE"}\NormalTok{, }\StringTok{"liestal SYY MSE"}\NormalTok{)}
\NormalTok{liestal\_mse }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(mse\_names, liestal.mse)}
\NormalTok{liestal\_mse}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                mse_names liestal.mse
## 1 liestal Regression MSE     4.77408
## 2         liestal DK MSE    13.13043
## 3        liestal KKW MSE    67.43478
## 4         liestal MH MSE          NA
## 5         liestal SL MSE          NA
## 6        liestal SYY MSE    82.34783
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Kyoto\textquotesingle{}s weighted average}
\NormalTok{line.kyoto }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(}\AttributeTok{data =}\NormalTok{ dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(models\_and\_actuals, year }\SpecialCharTok{\textless{}} \DecValTok{2023}\NormalTok{), kyoto\_day }\SpecialCharTok{\textasciitilde{}} \DecValTok{0} \SpecialCharTok{+}\NormalTok{ kyoto\_dk }\SpecialCharTok{+}\NormalTok{ kyoto\_kkw }\SpecialCharTok{+}\NormalTok{ kyoto\_mh }\SpecialCharTok{+}\NormalTok{ kyoto\_sl }\SpecialCharTok{+}\NormalTok{ kyoto\_syy)}
\NormalTok{line.kyoto.summ }\OtherTok{\textless{}{-}} \FunctionTok{summary}\NormalTok{(line.kyoto)}
\NormalTok{line.kyoto.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(line.kyoto.summ}\SpecialCharTok{$}\NormalTok{residuals}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\CommentTok{\# Get MSE\textquotesingle{}s}
\NormalTok{dk.kyoto.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{kyoto\_day }\SpecialCharTok{{-}}\NormalTok{ models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{kyoto\_dk)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{kkw.kyoto.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{kyoto\_day }\SpecialCharTok{{-}}\NormalTok{ models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{kyoto\_kkw)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{mh.kyoto.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{kyoto\_day }\SpecialCharTok{{-}}\NormalTok{ models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{kyoto\_mh)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{sl.kyoto.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{kyoto\_day }\SpecialCharTok{{-}}\NormalTok{ models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{kyoto\_sl)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{syy.kyoto.mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{kyoto\_day }\SpecialCharTok{{-}}\NormalTok{ models\_and\_actuals.pre23}\SpecialCharTok{$}\NormalTok{kyoto\_syy)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\CommentTok{\# MSE DF}
\NormalTok{kyoto.mse }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(line.kyoto.mse, dk.kyoto.mse, kkw.kyoto.mse, mh.kyoto.mse, sl.kyoto.mse, syy.kyoto.mse)}
\NormalTok{mse\_names }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"kyoto Regression MSE"}\NormalTok{, }\StringTok{"kyoto DK MSE"}\NormalTok{, }\StringTok{"kyoto KKW MSE"}\NormalTok{, }\StringTok{"kyoto MH MSE"}\NormalTok{, }\StringTok{"kyoto SL MSE"}\NormalTok{, }\StringTok{"kyoto SYY MSE"}\NormalTok{)}
\NormalTok{kyoto\_mse }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(mse\_names, kyoto.mse)}
\NormalTok{kyoto\_mse}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##              mse_names  kyoto.mse
## 1 kyoto Regression MSE  0.8347397
## 2         kyoto DK MSE  4.1304348
## 3        kyoto KKW MSE 13.6521739
## 4         kyoto MH MSE         NA
## 5         kyoto SL MSE  1.3043478
## 6        kyoto SYY MSE 13.8260870
\end{verbatim}

The regression has the lowest MSE among all of the models, consistently.
There is nothing unexpected about this, nor is this a particular sign of
model effectiveness; regression models are built to find reduced MSE
among a set of points.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# predictions using linear models}
\NormalTok{dc\_test }\OtherTok{\textless{}{-}}\NormalTok{ models\_and\_actuals }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(year }\SpecialCharTok{\textgreater{}} \DecValTok{2022}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(dc\_dk, dc\_kkw, dc\_mh, dc\_sl, dc\_syy)}

\NormalTok{dc\_predictions }\OtherTok{\textless{}{-}}\NormalTok{ line.dc }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{predict}\NormalTok{(}\AttributeTok{newdata =}\NormalTok{ dc\_test) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{as.vector}\NormalTok{()}

\NormalTok{liestal\_test }\OtherTok{\textless{}{-}}\NormalTok{ models\_and\_actuals }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(year }\SpecialCharTok{\textgreater{}} \DecValTok{2022}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(liestal\_dk, liestal\_kkw, liestal\_mh, liestal\_sl, liestal\_syy)}

\NormalTok{liestal\_predictions }\OtherTok{\textless{}{-}}\NormalTok{ line.liestal }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{predict}\NormalTok{(}\AttributeTok{newdata =}\NormalTok{ liestal\_test) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{as.vector}\NormalTok{()}

\NormalTok{kyoto\_test }\OtherTok{\textless{}{-}}\NormalTok{ models\_and\_actuals }\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(year }\SpecialCharTok{\textgreater{}} \DecValTok{2022}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(kyoto\_dk, kyoto\_kkw, kyoto\_mh, kyoto\_sl, kyoto\_syy)}

\NormalTok{kyoto\_predictions }\OtherTok{\textless{}{-}}\NormalTok{ line.kyoto }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{predict}\NormalTok{(}\AttributeTok{newdata =}\NormalTok{ kyoto\_test) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{as.vector}\NormalTok{()}

\NormalTok{vancouver\_predictions }\OtherTok{\textless{}{-}}\NormalTok{ models\_and\_actuals }\SpecialCharTok{\%\textgreater{}\%} 
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(year }\SpecialCharTok{\textgreater{}} \DecValTok{2022}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{mutate}\NormalTok{(}\StringTok{"vancouver\_guess"} \OtherTok{=}\NormalTok{ (vancouver\_dk }\SpecialCharTok{+}\NormalTok{ vancouver\_kkw }\SpecialCharTok{+}\NormalTok{ vancouver\_mh }\SpecialCharTok{+}\NormalTok{ vancouver\_sl }\SpecialCharTok{+}\NormalTok{ vancouver\_syy)}\SpecialCharTok{/}\DecValTok{5}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{select}\NormalTok{(vancouver\_guess) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{as.vector}\NormalTok{()}

\NormalTok{cherry\_predictions }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"2023"}\NormalTok{, }\StringTok{"2024"}\NormalTok{, }\StringTok{"2025"}\NormalTok{, }\StringTok{"2026"}\NormalTok{, }\StringTok{"2027"}\NormalTok{, }\StringTok{"2028"}\NormalTok{, }\StringTok{"2029"}\NormalTok{, }\StringTok{"2030"}\NormalTok{, }\StringTok{"2031"}\NormalTok{, }\StringTok{"2032"}\NormalTok{), dc\_predictions, liestal\_predictions, kyoto\_predictions, vancouver\_predictions)}
\end{Highlighting}
\end{Shaded}

Finally, we can see our predictions for 2023 and forward. As actual
values for Vancouver are not generally available, values for the
prediction were found by taking an unweighted average among the models.

\end{document}
